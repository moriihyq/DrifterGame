# PlayerAttackSystemå­˜æ¡£é›†æˆæŒ‡å—

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

è¯¥æ›´æ–°å°†ç°æœ‰çš„å­˜æ¡£ç³»ç»Ÿä¸PlayerAttackSystemé›†æˆï¼Œå®ç°è§’è‰²è¡€é‡å’Œç›¸å…³çŠ¶æ€çš„å®Œæ•´ä¿å­˜å’Œè¯»å–åŠŸèƒ½ã€‚

## ğŸ”§ ç³»ç»Ÿæ”¹åŠ¨

### 1. GameData.cs æ›´æ–°
**PlayerDataç±»æ–°å¢å­—æ®µ**ï¼š
```csharp
// PlayerAttackSystemä¸“ç”¨å­—æ®µ
public int attackDamage;      // æ”»å‡»ä¼¤å®³
public float attackCooldown;  // æ”»å‡»å†·å´æ—¶é—´
public float attackRadius;    // æ”»å‡»èŒƒå›´
public bool isDead;          // æ˜¯å¦æ­»äº¡
public float nextAttackTime; // ä¸‹æ¬¡æ”»å‡»æ—¶é—´
```

### 2. SaveManager.cs ä¸»è¦æ›´æ–°

#### æ•°æ®æ”¶é›† (CollectGameData)
- **ä¼˜å…ˆä½¿ç”¨PlayerAttackSystem**ï¼šç³»ç»Ÿä¼šé¦–å…ˆæŸ¥æ‰¾PlayerAttackSystemç»„ä»¶
- **å…œåº•æ–¹æ¡ˆ**ï¼šå¦‚æœæ‰¾ä¸åˆ°PlayerAttackSystemï¼Œä¼šä½¿ç”¨åŸæœ‰çš„PlayerController
- **å®Œæ•´æ•°æ®ä¿å­˜**ï¼š
  - è¡€é‡ä¿¡æ¯ï¼šå½“å‰è¡€é‡å’Œæœ€å¤§è¡€é‡
  - ä½ç½®ä¿¡æ¯ï¼šè§’è‰²çš„Transformä½ç½®
  - æ”»å‡»æ•°æ®ï¼šä¼¤å®³ã€å†·å´ã€èŒƒå›´ç­‰
  - çŠ¶æ€ä¿¡æ¯ï¼šæœå‘ã€æ­»äº¡çŠ¶æ€ç­‰

#### æ•°æ®åº”ç”¨ (ApplyGameData)
- **è¡€é‡æ¢å¤**ï¼šå°†ä¿å­˜çš„è¡€é‡å€¼æ¢å¤åˆ°PlayerAttackSystem
- **ä½ç½®æ¢å¤**ï¼šæ¢å¤è§’è‰²çš„ä½ç½®å’Œæœå‘
- **çŠ¶æ€æ¢å¤**ï¼šæ¢å¤æ”»å‡»ç›¸å…³çš„æ‰€æœ‰è®¾ç½®
- **UIåŒæ­¥**ï¼šè‡ªåŠ¨æ›´æ–°è¡€é‡æ¡æ˜¾ç¤º

#### åå°„æœºåˆ¶
ç”±äºPlayerAttackSystemçš„éƒ¨åˆ†å­—æ®µæ˜¯ç§æœ‰çš„ï¼Œç³»ç»Ÿä½¿ç”¨åå°„æ¥è®¿é—®ï¼š
```csharp
// è·å–ç§æœ‰å­—æ®µå€¼
private T GetPrivateFieldValue<T>(object obj, string fieldName)

// è®¾ç½®ç§æœ‰å­—æ®µå€¼
private void SetPrivateFieldValue(object obj, string fieldName, object value)
```

## ğŸ® æµ‹è¯•åŠŸèƒ½

### SaveLoadTester.cs æµ‹è¯•è„šæœ¬
æä¾›å®Œæ•´çš„æµ‹è¯•åŠŸèƒ½ï¼š

**å¿«æ·é”®**ï¼š
- `F5` - ä¿å­˜æ¸¸æˆåˆ°æ§½ä½0
- `F9` - ä»æ§½ä½0è¯»å–æ¸¸æˆ
- `F1` - å‡è¡€æµ‹è¯• (25ç‚¹ä¼¤å®³)
- `F2` - åŠ è¡€æµ‹è¯• (20ç‚¹æ¢å¤)
- `F3` - éšæœºç§»åŠ¨ä½ç½®

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- å®æ—¶æ˜¾ç¤ºå½“å‰è¡€é‡å’Œä½ç½®
- ä¿å­˜å‰åçš„çŠ¶æ€å¯¹æ¯”
- è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—è¾“å‡º
- å±å¹•GUIæ˜¾ç¤ºæµ‹è¯•ä¿¡æ¯

## ğŸ”„ å·¥ä½œæµç¨‹

### ä¿å­˜æµç¨‹
1. **è§¦å‘ä¿å­˜** â†’ SaveManager.SaveGame()
2. **æ”¶é›†æ•°æ®** â†’ CollectGameData()
3. **æŸ¥æ‰¾PlayerAttackSystem** â†’ FindPlayerAttackSystem()
4. **æå–è¡€é‡æ•°æ®** â†’ playerAttackSystem.Health/MaxHealth
5. **ä¿å­˜æ”»å‡»æ•°æ®** â†’ é€šè¿‡åå°„è·å–ç§æœ‰å­—æ®µ
6. **åºåˆ—åŒ–ä¸ºJSON** â†’ JsonUtility.ToJson()
7. **å†™å…¥æ–‡ä»¶** â†’ File.WriteAllText()

### è¯»å–æµç¨‹
1. **è§¦å‘è¯»å–** â†’ SaveManager.LoadGameInCurrentScene()
2. **è¯»å–æ–‡ä»¶** â†’ File.ReadAllText()
3. **ååºåˆ—åŒ–JSON** â†’ JsonUtility.FromJson()
4. **åº”ç”¨æ•°æ®** â†’ ApplyGameData()
5. **æ¢å¤è¡€é‡** â†’ é€šè¿‡åå°„è®¾ç½®ç§æœ‰å­—æ®µ
6. **æ›´æ–°ä½ç½®** â†’ transform.position
7. **åŒæ­¥UI** â†’ HealthBarManager.UpdateHealthDisplay()

## ğŸ“ æ–‡ä»¶ç»“æ„

```
SaveSystem/
â”œâ”€â”€ GameData.cs              # æ•°æ®ç»“æ„å®šä¹‰ (å·²æ›´æ–°)
â”œâ”€â”€ SaveManager.cs           # å­˜æ¡£ç®¡ç†å™¨ (å·²æ›´æ–°)
â””â”€â”€ PlayerAttackSystemå­˜æ¡£é›†æˆæŒ‡å—.md

Scripts/
â”œâ”€â”€ SaveLoadTester.cs        # å­˜æ¡£æµ‹è¯•è„šæœ¬ (æ–°å¢)
â”œâ”€â”€ HealthBarTester.cs       # è¡€é‡æ¡æµ‹è¯•è„šæœ¬
â””â”€â”€ HealthBarManager.cs      # è¡€é‡æ¡ç®¡ç†å™¨
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. åŸºç¡€è®¾ç½®
ç¡®ä¿åœºæ™¯ä¸­æœ‰ä»¥ä¸‹ç»„ä»¶ï¼š
- **SaveManager** (é€šå¸¸ä½œä¸ºå•ä¾‹å­˜åœ¨)
- **PlayerAttackSystem** (åœ¨ç©å®¶å¯¹è±¡ä¸Š)
- **HealthBarManager** (å¯é€‰ï¼Œç”¨äºUIåŒæ­¥)

### 2. æ·»åŠ æµ‹è¯•åŠŸèƒ½
```csharp
// åœ¨åœºæ™¯ä¸­æ·»åŠ ä¸€ä¸ªç©ºå¯¹è±¡
GameObject testObject = new GameObject("SaveLoadTester");
testObject.AddComponent<SaveLoadTester>();
```

### 3. ç¼–ç¨‹æ¥å£
```csharp
// ä¿å­˜æ¸¸æˆåˆ°æŒ‡å®šæ§½ä½
SaveManager.Instance.SaveGame(slotIndex);

// è¯»å–æ¸¸æˆä»æŒ‡å®šæ§½ä½
SaveManager.Instance.LoadGameInCurrentScene(slotIndex);

// è·å–å­˜æ¡£ä¿¡æ¯
List<SaveInfo> saveInfos = SaveManager.Instance.GetAllSaveInfos();
```

## âš¡ é«˜çº§åŠŸèƒ½

### 1. è‡ªåŠ¨è¡€é‡æ¡åŒæ­¥
è¯»å–å­˜æ¡£åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ›´æ–°è¡€é‡æ¡æ˜¾ç¤ºï¼š
```csharp
HealthBarManager healthBarManager = HealthBarManager.Instance;
if (healthBarManager != null)
{
    healthBarManager.UpdateHealthDisplay(true);
}
```

### 2. é”™è¯¯å¤„ç†
- **ç»„ä»¶ç¼ºå¤±**ï¼šæä¾›è¯¦ç»†çš„é”™è¯¯æ—¥å¿—å’Œå…œåº•æ–¹æ¡ˆ
- **åå°„å¤±è´¥**ï¼šå®‰å…¨å¤„ç†ç§æœ‰å­—æ®µè®¿é—®å¤±è´¥çš„æƒ…å†µ
- **æ–‡ä»¶æŸå**ï¼šæ•è·JSONè§£æå¼‚å¸¸

### 3. è°ƒè¯•åŠŸèƒ½
- **è¯¦ç»†æ—¥å¿—**ï¼šè®°å½•ä¿å­˜å’Œè¯»å–çš„æ¯ä¸ªæ­¥éª¤
- **æ•°æ®éªŒè¯**ï¼šåœ¨åº”ç”¨æ•°æ®å‰éªŒè¯æ•°æ®å®Œæ•´æ€§
- **æµ‹è¯•æ¨¡å¼**ï¼šé€šè¿‡SaveLoadTesterè¿›è¡Œå®Œæ•´åŠŸèƒ½æµ‹è¯•

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šè¡€é‡æ²¡æœ‰æ­£ç¡®ä¿å­˜
**å¯èƒ½åŸå› **ï¼š
- PlayerAttackSystemç»„ä»¶æœªæ‰¾åˆ°
- ç©å®¶å¯¹è±¡æ ‡ç­¾ä¸æ˜¯"Player"
- ç§æœ‰å­—æ®µåç§°ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ç©å®¶å¯¹è±¡æ˜¯å¦æœ‰PlayerAttackSystemç»„ä»¶
- ç¡®ä¿ç©å®¶å¯¹è±¡æ ‡ç­¾è®¾ç½®ä¸º"Player"
- æŸ¥çœ‹æ§åˆ¶å°çš„è°ƒè¯•æ—¥å¿—

### é—®é¢˜2ï¼šè¯»å–åè¡€é‡æ¡ä¸æ›´æ–°
**å¯èƒ½åŸå› **ï¼š
- HealthBarManageræœªæ‰¾åˆ°
- è¡€é‡æ¡UIç»„ä»¶ç¼ºå¤±

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿åœºæ™¯ä¸­æœ‰HealthBarManager
- æ£€æŸ¥è¡€é‡æ¡UIæ˜¯å¦æ­£ç¡®è®¾ç½®

### é—®é¢˜3ï¼šåå°„è®¿é—®å¤±è´¥
**å¯èƒ½åŸå› **ï¼š
- PlayerAttackSystemçš„å­—æ®µåç§°æ”¹å˜
- å­—æ®µè®¿é—®æƒé™æ”¹å˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥PlayerAttackSystemçš„æºä»£ç 
- æ›´æ–°åå°„ä¸­çš„å­—æ®µåç§°
- **é‡è¦**ï¼šè¡€é‡å­—æ®µåä¸º `currentHealth` è€Œä¸æ˜¯ `health`

**æ­£ç¡®çš„å­—æ®µåç§°**ï¼š
```csharp
// PlayerAttackSystemä¸­çš„å®é™…å­—æ®µå
private int currentHealth;    // å½“å‰è¡€é‡
private int maxHealth;        // æœ€å¤§è¡€é‡
private int attackDamage;     // æ”»å‡»ä¼¤å®³
private float attackCooldown; // æ”»å‡»å†·å´
private float attackRadius;   // æ”»å‡»èŒƒå›´
private bool isDead;          // æ­»äº¡çŠ¶æ€
private float nextAttackTime; // ä¸‹æ¬¡æ”»å‡»æ—¶é—´
```

## ğŸ”„ ç‰ˆæœ¬å…¼å®¹æ€§

è¯¥ç³»ç»Ÿè®¾è®¡ä¸ºå‘åå…¼å®¹ï¼š
- **æ–°ç³»ç»Ÿ**ï¼šä¼˜å…ˆä½¿ç”¨PlayerAttackSystem
- **æ—§ç³»ç»Ÿ**ï¼šè‡ªåŠ¨å…œåº•åˆ°PlayerController
- **æ··åˆä½¿ç”¨**ï¼šå¯ä»¥åŒæ—¶æ”¯æŒä¸¤ç§ç³»ç»Ÿ

## ğŸ“ˆ æ€§èƒ½è€ƒè™‘

- **åå°„å¼€é”€**ï¼šä»…åœ¨ä¿å­˜/è¯»å–æ—¶ä½¿ç”¨ï¼Œå¯¹æ¸¸æˆæ€§èƒ½å½±å“æå°
- **å†…å­˜ä½¿ç”¨**ï¼šä¿å­˜æ•°æ®ç»“æ„ç®€æ´ï¼Œå†…å­˜å ç”¨æœ€å°
- **æ–‡ä»¶å¤§å°**ï¼šJSONæ ¼å¼ç´§å‡‘ï¼Œå­˜æ¡£æ–‡ä»¶å¾ˆå°

## ğŸ¯ æµ‹è¯•å»ºè®®

1. **åŸºç¡€æµ‹è¯•**ï¼šä½¿ç”¨SaveLoadTesteræµ‹è¯•åŸºæœ¬ä¿å­˜/è¯»å–
2. **è¾¹ç•Œæµ‹è¯•**ï¼šæµ‹è¯•è¡€é‡ä¸º0ã€æ»¡è¡€ç­‰è¾¹ç•Œæƒ…å†µ
3. **å¼‚å¸¸æµ‹è¯•**ï¼šæµ‹è¯•ç»„ä»¶ç¼ºå¤±ã€æ–‡ä»¶æŸåç­‰å¼‚å¸¸æƒ…å†µ
4. **æ€§èƒ½æµ‹è¯•**ï¼šæµ‹è¯•å¤§é‡ä¿å­˜/è¯»å–æ“ä½œçš„æ€§èƒ½

å®Œæˆä»¥ä¸Šè®¾ç½®åï¼Œæ‚¨å°±æ‹¥æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„PlayerAttackSystemå­˜æ¡£ç³»ç»Ÿï¼ 